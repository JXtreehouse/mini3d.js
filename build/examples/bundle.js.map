{"version":3,"file":"bundle.js","sources":["../../examples/src/main.js"],"sourcesContent":["var VSHADER_SOURCE=`\r\n    attribute vec4 a_Position;\r\n    attribute vec4 a_Color;\r\n    attribute float a_Custom;    \r\n    uniform mat4 u_mvpMatrix;\r\n    varying vec4 v_Color;\r\n    varying float v_Custom;\r\n    void main(){\r\n        gl_Position = u_mvpMatrix * a_Position;\r\n        v_Color = a_Color;\r\n        v_Custom = a_Custom;\r\n    }\r\n`;\r\n\r\nvar FSHADER_SOURCE=`\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    varying vec4 v_Color;\r\n    varying float v_Custom;\r\n    void main(){\r\n        gl_FragColor = v_Color * v_Custom;\r\n    }\r\n`;\r\n\r\nconst Semantic_Custom = 'custom';\r\n\r\nfunction createMesh(){\r\n\r\n    let format = new mini3d.VertexFormat();\r\n    format.addAttrib(mini3d.VertexSemantic.POSITION, 3);\r\n    format.addAttrib(mini3d.VertexSemantic.COLOR, 3);\r\n    format.addAttrib(Semantic_Custom, 1);\r\n\r\n    let mesh = new mini3d.Mesh(format);    \r\n    let position_data = [\r\n        //Three triangles on the right side\r\n        0.75, 1.0, -4.0,\r\n        0.25, -1.0, -4.0,\r\n        1.25, -1.0, -4.0,\r\n        \r\n        0.75, 1.0, -2.0,\r\n        0.25, -1.0, -2.0,\r\n        1.25, -1.0, -2.0,\r\n\r\n        0.75, 1.0, 0.0,\r\n        0.25, -1.0, 0.0,\r\n        1.25, -1.0, 0.0,\r\n\r\n        //Three triangles on the left side\r\n        -0.75, 1.0, -4.0,\r\n        -1.25, -1.0, -4.0,\r\n        -0.25, -1.0, -4.0,\r\n        \r\n        -0.75, 1.0, -2.0,\r\n        -1.25, -1.0, -2.0,\r\n        -0.25, -1.0, -2.0,\r\n        \r\n        -0.75, 1.0, 0.0,\r\n        -1.25, -1.0, 0.0,\r\n        -0.25, -1.0, 0.0        \r\n    ];\r\n    let color_data = [\r\n        0.4, 1.0, 0.4,\r\n        0.4, 1.0, 0.4,\r\n        1.0, 0.4, 0.4,\r\n        \r\n        1.0, 1.0, 0.4,\r\n        1.0, 1.0, 0.4,\r\n        1.0, 0.4, 0.4,\r\n\r\n        0.4, 0.4, 1.0,\r\n        0.4, 0.4, 1.0,\r\n        1.0, 0.4, 0.4,\r\n\r\n        0.4, 1.0, 0.4,\r\n        0.4, 1.0, 0.4,\r\n        1.0, 0.4, 0.4,\r\n        \r\n        1.0, 1.0, 0.4,\r\n        1.0, 1.0, 0.4,\r\n        1.0, 0.4, 0.4,\r\n        \r\n        0.4, 0.4, 1.0,\r\n        0.4, 0.4, 1.0,\r\n        1.0, 0.4, 0.4\r\n    ];\r\n    let custom_data = [\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1\r\n    ];\r\n\r\n    mesh.setVertexData(mini3d.VertexSemantic.POSITION, position_data);    \r\n    mesh.setVertexData(mini3d.VertexSemantic.COLOR, color_data);\r\n    mesh.setVertexData(Semantic_Custom, custom_data);\r\n    mesh.upload();            \r\n\r\n    return mesh;   \r\n}\r\n\r\nlet g_eyeX, g_eyeY, g_eyeZ;\r\n\r\nfunction example(gl){\r\n    let shader = new mini3d.Shader();\r\n    if(!shader.create(VSHADER_SOURCE, FSHADER_SOURCE)){\r\n        console.log(\"Failed to initialize shaders\");\r\n        return;\r\n    }\r\n\r\n    shader.mapAttributeSemantic(mini3d.VertexSemantic.POSITION, 'a_Position');\r\n    shader.mapAttributeSemantic(mini3d.VertexSemantic.COLOR, 'a_Color');\r\n    shader.mapAttributeSemantic(Semantic_Custom, 'a_Custom');\r\n\r\n    shader.use();    \r\n    \r\n    let viewMatrix = new mini3d.Matrix4();\r\n    g_eyeX = 0;\r\n    g_eyeY = 0;\r\n    g_eyeZ = 5;\r\n\r\n    var mesh = createMesh(); \r\n\r\n    document.onkeydown = function(ev){\r\n        keydown(ev, mesh, shader, viewMatrix);\r\n    }\r\n\r\n         \r\n\r\n    //let modelMatrix = new mini3d.Matrix4();\r\n    //modelMatrix.setRotate(-10, 0, 0, 1); //Rotate around z-axis\r\n\r\n    //let modelViewMatrix = viewMatrix.multiply(modelMatrix);\r\n\r\n    gl.clearColor(0, 0, 0, 1);\r\n    //gl.enable(gl.DEPTH_TEST);\r\n\r\n    draw(mesh, shader, viewMatrix);\r\n\r\n}\r\n\r\nfunction keydown(ev, mesh, shader, viewMatrix){\r\n    if(ev.keyCode==39){ //right arrow\r\n        g_eyeX += 0.01;\r\n    } else if(ev.keyCode==37){ //left arrow\r\n        g_eyeX -= 0.01;\r\n    } else {\r\n        return;\r\n    }\r\n\r\n    draw(mesh, shader, viewMatrix);\r\n}\r\n\r\nfunction draw(mesh, shader, viewMatrix){\r\n    viewMatrix.setLookAtGL(g_eyeX, g_eyeY, g_eyeZ,  0, 0, -100,  0, 1, 0); \r\n    \r\n    let projMatrix = new mini3d.Matrix4();\r\n    projMatrix.setPerspective(30, mini3d.canvas.width/mini3d.canvas.height, 1, 100);\r\n\r\n    let mvpMatrix = projMatrix.multiply(viewMatrix);\r\n    \r\n    shader.setUniform('u_mvpMatrix', mvpMatrix.elements);\r\n\r\n    let gl = mini3d.gl;\r\n    gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);\r\n    mesh.render(shader);\r\n}\r\n\r\nexport default function main(){\r\n    console.log('main');\r\n    example(mini3d.gl);\r\n}\r\n"],"names":["VSHADER_SOURCE","FSHADER_SOURCE","Semantic_Custom","createMesh","format","mini3d","VertexFormat","addAttrib","VertexSemantic","POSITION","COLOR","mesh","Mesh","position_data","color_data","custom_data","setVertexData","upload","g_eyeX","g_eyeY","g_eyeZ","example","gl","shader","Shader","create","console","log","mapAttributeSemantic","use","viewMatrix","Matrix4","document","onkeydown","ev","keydown","clearColor","draw","keyCode","setLookAtGL","projMatrix","setPerspective","canvas","width","height","mvpMatrix","multiply","setUniform","elements","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","render","main"],"mappings":";;;IAAA,IAAIA,cAAc,kUAAlB;IAcA,IAAIC,cAAc,gMAAlB;IAWA,IAAMC,eAAe,GAAG,QAAxB;;IAEA,SAASC,UAAT,GAAqB;IAEjB,MAAIC,MAAM,GAAG,IAAIC,MAAM,CAACC,YAAX,EAAb;IACAF,EAAAA,MAAM,CAACG,SAAP,CAAiBF,MAAM,CAACG,cAAP,CAAsBC,QAAvC,EAAiD,CAAjD;IACAL,EAAAA,MAAM,CAACG,SAAP,CAAiBF,MAAM,CAACG,cAAP,CAAsBE,KAAvC,EAA8C,CAA9C;IACAN,EAAAA,MAAM,CAACG,SAAP,CAAiBL,eAAjB,EAAkC,CAAlC;IAEA,MAAIS,IAAI,GAAG,IAAIN,MAAM,CAACO,IAAX,CAAgBR,MAAhB,CAAX;IACA,MAAIS,aAAa,GAAG;IAEhB,MAFgB,EAEV,GAFU,EAEL,CAAC,GAFI,EAGhB,IAHgB,EAGV,CAAC,GAHS,EAGJ,CAAC,GAHG,EAIhB,IAJgB,EAIV,CAAC,GAJS,EAIJ,CAAC,GAJG,EAMhB,IANgB,EAMV,GANU,EAML,CAAC,GANI,EAOhB,IAPgB,EAOV,CAAC,GAPS,EAOJ,CAAC,GAPG,EAQhB,IARgB,EAQV,CAAC,GARS,EAQJ,CAAC,GARG,EAUhB,IAVgB,EAUV,GAVU,EAUL,GAVK,EAWhB,IAXgB,EAWV,CAAC,GAXS,EAWJ,GAXI,EAYhB,IAZgB,EAYV,CAAC,GAZS,EAYJ,GAZI;IAehB,GAAC,IAfe,EAeT,GAfS,EAeJ,CAAC,GAfG,EAgBhB,CAAC,IAhBe,EAgBT,CAAC,GAhBQ,EAgBH,CAAC,GAhBE,EAiBhB,CAAC,IAjBe,EAiBT,CAAC,GAjBQ,EAiBH,CAAC,GAjBE,EAmBhB,CAAC,IAnBe,EAmBT,GAnBS,EAmBJ,CAAC,GAnBG,EAoBhB,CAAC,IApBe,EAoBT,CAAC,GApBQ,EAoBH,CAAC,GApBE,EAqBhB,CAAC,IArBe,EAqBT,CAAC,GArBQ,EAqBH,CAAC,GArBE,EAuBhB,CAAC,IAvBe,EAuBT,GAvBS,EAuBJ,GAvBI,EAwBhB,CAAC,IAxBe,EAwBT,CAAC,GAxBQ,EAwBH,GAxBG,EAyBhB,CAAC,IAzBe,EAyBT,CAAC,GAzBQ,EAyBH,GAzBG,CAApB;IA2BA,MAAIC,UAAU,GAAG,CACb,GADa,EACR,GADQ,EACH,GADG,EAEb,GAFa,EAER,GAFQ,EAEH,GAFG,EAGb,GAHa,EAGR,GAHQ,EAGH,GAHG,EAKb,GALa,EAKR,GALQ,EAKH,GALG,EAMb,GANa,EAMR,GANQ,EAMH,GANG,EAOb,GAPa,EAOR,GAPQ,EAOH,GAPG,EASb,GATa,EASR,GATQ,EASH,GATG,EAUb,GAVa,EAUR,GAVQ,EAUH,GAVG,EAWb,GAXa,EAWR,GAXQ,EAWH,GAXG,EAab,GAba,EAaR,GAbQ,EAaH,GAbG,EAcb,GAda,EAcR,GAdQ,EAcH,GAdG,EAeb,GAfa,EAeR,GAfQ,EAeH,GAfG,EAiBb,GAjBa,EAiBR,GAjBQ,EAiBH,GAjBG,EAkBb,GAlBa,EAkBR,GAlBQ,EAkBH,GAlBG,EAmBb,GAnBa,EAmBR,GAnBQ,EAmBH,GAnBG,EAqBb,GArBa,EAqBR,GArBQ,EAqBH,GArBG,EAsBb,GAtBa,EAsBR,GAtBQ,EAsBH,GAtBG,EAuBb,GAvBa,EAuBR,GAvBQ,EAuBH,GAvBG,CAAjB;IAyBA,MAAIC,WAAW,GAAG,CACd,CADc,EAEd,CAFc,EAGd,CAHc,EAId,CAJc,EAKd,CALc,EAMd,CANc,EAOd,CAPc,EAQd,CARc,EASd,CATc,EAUd,CAVc,EAWd,CAXc,EAYd,CAZc,EAad,CAbc,EAcd,CAdc,EAed,CAfc,EAgBd,CAhBc,EAiBd,CAjBc,EAkBd,CAlBc,CAAlB;IAqBAJ,EAAAA,IAAI,CAACK,aAAL,CAAmBX,MAAM,CAACG,cAAP,CAAsBC,QAAzC,EAAmDI,aAAnD;IACAF,EAAAA,IAAI,CAACK,aAAL,CAAmBX,MAAM,CAACG,cAAP,CAAsBE,KAAzC,EAAgDI,UAAhD;IACAH,EAAAA,IAAI,CAACK,aAAL,CAAmBd,eAAnB,EAAoCa,WAApC;IACAJ,EAAAA,IAAI,CAACM,MAAL;IAEA,SAAON,IAAP;IACH;;IAED,IAAIO,MAAJ,EAAYC,MAAZ,EAAoBC,MAApB;;IAEA,SAASC,OAAT,CAAiBC,EAAjB,EAAoB;IAChB,MAAIC,MAAM,GAAG,IAAIlB,MAAM,CAACmB,MAAX,EAAb;;IACA,MAAG,CAACD,MAAM,CAACE,MAAP,CAAczB,cAAd,EAA8BC,cAA9B,CAAJ,EAAkD;IAC9CyB,IAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ;IACA;IACH;;IAEDJ,EAAAA,MAAM,CAACK,oBAAP,CAA4BvB,MAAM,CAACG,cAAP,CAAsBC,QAAlD,EAA4D,YAA5D;IACAc,EAAAA,MAAM,CAACK,oBAAP,CAA4BvB,MAAM,CAACG,cAAP,CAAsBE,KAAlD,EAAyD,SAAzD;IACAa,EAAAA,MAAM,CAACK,oBAAP,CAA4B1B,eAA5B,EAA6C,UAA7C;IAEAqB,EAAAA,MAAM,CAACM,GAAP;IAEA,MAAIC,UAAU,GAAG,IAAIzB,MAAM,CAAC0B,OAAX,EAAjB;IACAb,EAAAA,MAAM,GAAG,CAAT;IACAC,EAAAA,MAAM,GAAG,CAAT;IACAC,EAAAA,MAAM,GAAG,CAAT;IAEA,MAAIT,IAAI,GAAGR,UAAU,EAArB;;IAEA6B,EAAAA,QAAQ,CAACC,SAAT,GAAqB,UAASC,EAAT,EAAY;IAC7BC,IAAAA,OAAO,CAACD,EAAD,EAAKvB,IAAL,EAAWY,MAAX,EAAmBO,UAAnB,CAAP;IACH,GAFD,CApBgB;IA2BhB;IAEA;;;IAEAR,EAAAA,EAAE,CAACc,UAAH,CAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EA/BgB;;IAkChBC,EAAAA,IAAI,CAAC1B,IAAD,EAAOY,MAAP,EAAeO,UAAf,CAAJ;IAEH;;IAED,SAASK,OAAT,CAAiBD,EAAjB,EAAqBvB,IAArB,EAA2BY,MAA3B,EAAmCO,UAAnC,EAA8C;IAC1C,MAAGI,EAAE,CAACI,OAAH,IAAY,EAAf,EAAkB;IAAE;IAChBpB,IAAAA,MAAM,IAAI,IAAV;IACH,GAFD,MAEO,IAAGgB,EAAE,CAACI,OAAH,IAAY,EAAf,EAAkB;IAAE;IACvBpB,IAAAA,MAAM,IAAI,IAAV;IACH,GAFM,MAEA;IACH;IACH;;IAEDmB,EAAAA,IAAI,CAAC1B,IAAD,EAAOY,MAAP,EAAeO,UAAf,CAAJ;IACH;;IAED,SAASO,IAAT,CAAc1B,IAAd,EAAoBY,MAApB,EAA4BO,UAA5B,EAAuC;IACnCA,EAAAA,UAAU,CAACS,WAAX,CAAuBrB,MAAvB,EAA+BC,MAA/B,EAAuCC,MAAvC,EAAgD,CAAhD,EAAmD,CAAnD,EAAsD,CAAC,GAAvD,EAA6D,CAA7D,EAAgE,CAAhE,EAAmE,CAAnE;IAEA,MAAIoB,UAAU,GAAG,IAAInC,MAAM,CAAC0B,OAAX,EAAjB;IACAS,EAAAA,UAAU,CAACC,cAAX,CAA0B,EAA1B,EAA8BpC,MAAM,CAACqC,MAAP,CAAcC,KAAd,GAAoBtC,MAAM,CAACqC,MAAP,CAAcE,MAAhE,EAAwE,CAAxE,EAA2E,GAA3E;IAEA,MAAIC,SAAS,GAAGL,UAAU,CAACM,QAAX,CAAoBhB,UAApB,CAAhB;IAEAP,EAAAA,MAAM,CAACwB,UAAP,CAAkB,aAAlB,EAAiCF,SAAS,CAACG,QAA3C;IAEA,MAAI1B,EAAE,GAAGjB,MAAM,CAACiB,EAAhB;IACAA,EAAAA,EAAE,CAAC2B,KAAH,CAAS3B,EAAE,CAAC4B,gBAAH,GAAoB5B,EAAE,CAAC6B,gBAAhC;IACAxC,EAAAA,IAAI,CAACyC,MAAL,CAAY7B,MAAZ;IACH;;AAED,IAAe,SAAS8B,IAAT,GAAe;IAC1B3B,EAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;IACAN,EAAAA,OAAO,CAAChB,MAAM,CAACiB,EAAR,CAAP;IACH;;;;;;;;"}