{"version":3,"file":"bundle.js","sources":["../../examples/src/main.js"],"sourcesContent":["var VSHADER_SOURCE=`\r\n    attribute vec4 a_Position;\r\n    attribute vec4 a_Color;\r\n    attribute float a_Custom;    \r\n    uniform mat4 u_mvpMatrix;\r\n    varying vec4 v_Color;\r\n    varying float v_Custom;\r\n    void main(){\r\n        gl_Position = u_mvpMatrix * a_Position;\r\n        v_Color = a_Color;\r\n        v_Custom = a_Custom;\r\n    }\r\n`;\r\n\r\nvar FSHADER_SOURCE=`\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    varying vec4 v_Color;\r\n    varying float v_Custom;\r\n    void main(){\r\n        gl_FragColor = v_Color * v_Custom;\r\n    }\r\n`;\r\n\r\nconst Semantic_Custom = 'custom';\r\n\r\nfunction createMesh(){\r\n\r\n    let format = new mini3d.VertexFormat();\r\n    format.addAttrib(mini3d.VertexSemantic.POSITION, 3);\r\n    format.addAttrib(mini3d.VertexSemantic.COLOR, 3);\r\n    format.addAttrib(Semantic_Custom, 1);\r\n\r\n    let mesh = new mini3d.Mesh(format);    \r\n    let position_data = [\r\n        0.0, 0.6, -0.4,\r\n        -0.5, -0.4, -0.4,\r\n        0.5, -0.4, -0.4,\r\n        0.5, 0.4, -0.2,\r\n        -0.5, 0.4, -0.2,\r\n        0.0, -0.6, -0.2,\r\n        0.0, 0.5, 0.0,\r\n        -0.5, -0.5, 0.0,\r\n        0.5, -0.5, 0.0\r\n    ];\r\n    let color_data = [\r\n        0.4, 1.0, 0.4,\r\n        0.4, 1.0, 0.4,\r\n        1.0, 0.4, 0.4,\r\n        1.0, 0.4, 0.4,\r\n        1.0, 1.0, 0.4,\r\n        1.0, 1.0, 0.4,\r\n        0.4, 0.4, 1.0,\r\n        0.4, 0.4, 1.0,\r\n        1.0, 0.4, 0.4\r\n    ];\r\n    let custom_data = [\r\n        0.5,\r\n        0.5,\r\n        0.5,\r\n        1,\r\n        1,\r\n        1,\r\n        2,\r\n        2,\r\n        2\r\n    ];\r\n\r\n    mesh.setVertexData(mini3d.VertexSemantic.POSITION, position_data);    \r\n    mesh.setVertexData(mini3d.VertexSemantic.COLOR, color_data);\r\n    mesh.setVertexData(Semantic_Custom, custom_data);\r\n    mesh.upload();            \r\n\r\n    return mesh;   \r\n}\r\n\r\nlet g_eyeX, g_eyeY, g_eyeZ;\r\n\r\nfunction example(gl){\r\n    let shader = new mini3d.Shader();\r\n    if(!shader.create(VSHADER_SOURCE, FSHADER_SOURCE)){\r\n        console.log(\"Failed to initialize shaders\");\r\n        return;\r\n    }\r\n\r\n    shader.mapAttributeSemantic(mini3d.VertexSemantic.POSITION, 'a_Position');\r\n    shader.mapAttributeSemantic(mini3d.VertexSemantic.COLOR, 'a_Color');\r\n    shader.mapAttributeSemantic(Semantic_Custom, 'a_Custom');\r\n\r\n    shader.use();    \r\n    \r\n    let viewMatrix = new mini3d.Matrix4();\r\n    g_eyeX = 0.2;\r\n    g_eyeY = 0.25;\r\n    g_eyeZ = 0.25;\r\n\r\n    var mesh = createMesh(); \r\n\r\n    document.onkeydown = function(ev){\r\n        keydown(ev, mesh, shader, viewMatrix);\r\n    }\r\n\r\n         \r\n\r\n    //let modelMatrix = new mini3d.Matrix4();\r\n    //modelMatrix.setRotate(-10, 0, 0, 1); //Rotate around z-axis\r\n\r\n    //let modelViewMatrix = viewMatrix.multiply(modelMatrix);\r\n\r\n    gl.clearColor(0, 0, 0, 1);\r\n    //gl.enable(gl.DEPTH_TEST);\r\n\r\n    draw(mesh, shader, viewMatrix);\r\n\r\n}\r\n\r\nfunction keydown(ev, mesh, shader, viewMatrix){\r\n    if(ev.keyCode==39){ //right arrow\r\n        g_eyeX += 0.01;\r\n    } else if(ev.keyCode==37){ //left arrow\r\n        g_eyeX -= 0.01;\r\n    } else {\r\n        return;\r\n    }\r\n\r\n    draw(mesh, shader, viewMatrix);\r\n}\r\n\r\nfunction draw(mesh, shader, viewMatrix){\r\n    viewMatrix.setLookAtGL(g_eyeX, g_eyeY, g_eyeZ,  0, 0, 0,  0, 1, 0); \r\n    let projMatrix = new mini3d.Matrix4();\r\n    projMatrix.setOrtho(-1.0, 1.0, -1.0, 1.0, 0.0, 0.5); \r\n    //projMatrix.setOrtho(-0.5,0.5,-0.5,0.5,0,0.5);\r\n    //projMatrix.setOrtho(-0.3,0.3,-1.0,1.0,0,0.5);\r\n\r\n    let mvpMatrix = projMatrix;//.multiply(viewMatrix);\r\n    \r\n    shader.setUniform('u_mvpMatrix', mvpMatrix.elements);\r\n\r\n    let gl = mini3d.gl;\r\n    gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);\r\n    mesh.render(shader);\r\n}\r\n\r\nexport default function main(){\r\n    console.log('main');\r\n    example(mini3d.gl);\r\n}\r\n"],"names":["VSHADER_SOURCE","FSHADER_SOURCE","Semantic_Custom","createMesh","format","mini3d","VertexFormat","addAttrib","VertexSemantic","POSITION","COLOR","mesh","Mesh","position_data","color_data","custom_data","setVertexData","upload","g_eyeX","g_eyeY","g_eyeZ","example","gl","shader","Shader","create","console","log","mapAttributeSemantic","use","viewMatrix","Matrix4","document","onkeydown","ev","keydown","clearColor","draw","keyCode","setLookAtGL","projMatrix","setOrtho","mvpMatrix","setUniform","elements","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","render","main"],"mappings":"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"}