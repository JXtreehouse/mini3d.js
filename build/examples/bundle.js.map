{"version":3,"file":"bundle.js","sources":["../../examples/src/main.js"],"sourcesContent":["var VSHADER_SOURCE=`\n    attribute vec4 a_Position;\n    attribute vec4 a_Color;\n    attribute float a_Custom;    \n    uniform mat4 u_mvpMatrix;\n    varying vec4 v_Color;\n    void main(){\n        gl_Position = u_mvpMatrix * a_Position;\n        v_Color = a_Color;\n    }\n`;\n\nvar FSHADER_SOURCE=`\n    #ifdef GL_ES\n    precision mediump float;\n    #endif\n    varying vec4 v_Color;\n    void main(){\n        gl_FragColor = v_Color;\n    }\n`;\n\nfunction createMesh(){\n\n    let format = new mini3d.VertexFormat();\n    format.addAttrib(mini3d.VertexSemantic.POSITION, 3);\n    format.addAttrib(mini3d.VertexSemantic.COLOR, 3);\n\n    // cube\n    //       ^ Y\n    //       | \n    //       |\n    //       / -------> X \n    //      /\n    //     v\n    //    Z\n    //\n    //    v6----- v5\n    //   /|      /|\n    //  v1------v0|\n    //  | |     | |\n    //  | |v7---|-|v4\n    //  |/      |/\n    //  v2------v3\n\n    let mesh = new mini3d.Mesh(format);  \n    //6个面（12个三角形），24个顶点  \n    let position_data = [\n        //v0-v1-v2-v3 front (0,1,2,3)\n        1.0, 1.0, 1.0,  -1.0, 1.0, 1.0,  -1.0, -1.0, 1.0,  1.0, -1.0, 1.0,\n        //v0-v3-v4-v5 right (4,5,6,7)\n        1.0, 1.0, 1.0,  1.0, -1.0, 1.0,  1.0, -1.0, -1.0,  1.0, 1.0, -1.0,\n        //v0-v5-v6-v1 top (8,9,10,11)\n        1.0, 1.0, 1.0,  1.0, 1.0, -1.0,  -1.0, 1.0, -1.0, -1.0, 1.0, 1.0,\n        //v1-v6-v7-v2 left (12,13,14,15)\n        -1.0, 1.0, 1.0,  -1.0, 1.0, -1.0,  -1.0, -1.0, -1.0,  -1.0, -1.0, 1.0,\n        //v7-v4-v3-v2 bottom (16,17,18,19)\n        -1.0, -1.0, -1.0,  1.0, -1.0, -1.0,  1.0, -1.0, 1.0,  -1.0, -1.0, 1.0,\n        //v4-v7-v6-v5 back (20,21,22,23)\n        1.0, -1.0, -1.0,  -1.0, -1.0, -1.0,  -1.0, 1.0, -1.0,  1.0, 1.0, -1.0        \n    ];\n    let color_data = [\n        //v0-v1-v2-v3 front (blue)\n        0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0,\n        //v0-v3-v4-v5 right (green)\n        0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0,\n        //v0-v5-v6-v1 top (red)\n        1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0,\n        //v1-v6-v7-v2 left (yellow)\n        1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0,\n        //v7-v4-v3-v2 bottom (white)\n        1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,\n        //v4-v7-v6-v5 back\n        0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0\n    ];\n\n    let triangels = [\n        0,1,2, 0,2,3,       //front\n        4,5,6, 4,6,7,       //right\n        8,9,10, 8,10,11,    //top\n        12,13,14, 12,14,15, //left\n        16,17,18, 16,18,19, //bottom\n        20,21,22, 20,22,23  //back\n    ]\n\n\n    mesh.setVertexData(mini3d.VertexSemantic.POSITION, position_data);    \n    mesh.setVertexData(mini3d.VertexSemantic.COLOR, color_data);   \n    mesh.setTriangles(triangels);\n    mesh.upload();            \n\n    return mesh;   \n}\n\nlet g_eyeX, g_eyeY, g_eyeZ;\n\nfunction example(gl){\n    let shader = new mini3d.Shader();\n    if(!shader.create(VSHADER_SOURCE, FSHADER_SOURCE)){\n        console.log(\"Failed to initialize shaders\");\n        return;\n    }\n\n    shader.mapAttributeSemantic(mini3d.VertexSemantic.POSITION, 'a_Position');\n    shader.mapAttributeSemantic(mini3d.VertexSemantic.COLOR, 'a_Color');    \n\n    shader.use();    \n    \n    let viewMatrix = new mini3d.Matrix4();\n    g_eyeX = 3;\n    g_eyeY = 3;\n    g_eyeZ = 7;\n\n    var mesh = createMesh(); \n\n    document.onkeydown = function(ev){\n        keydown(ev, mesh, shader, viewMatrix);\n    }\n\n         \n\n    //let modelMatrix = new mini3d.Matrix4();\n    //modelMatrix.setRotate(-10, 0, 0, 1); //Rotate around z-axis\n\n    //let modelViewMatrix = viewMatrix.multiply(modelMatrix);\n\n    gl.clearColor(0, 0, 0, 1);\n    gl.clearDepth(1.0);\n    gl.enable(gl.DEPTH_TEST);\n\n    draw(mesh, shader, viewMatrix);\n\n}\n\nfunction keydown(ev, mesh, shader, viewMatrix){\n    if(ev.keyCode==39){ //right arrow\n        g_eyeX += 0.1;\n    } else if(ev.keyCode==37){ //left arrow\n        g_eyeX -= 0.1;\n    } else {\n        return;\n    }\n\n    draw(mesh, shader, viewMatrix);\n}\n\nfunction draw(mesh, shader, viewMatrix){\n    viewMatrix.setLookAtGL(g_eyeX, g_eyeY, g_eyeZ,  0, 0, 0,  0, 1, 0); \n    \n    let projMatrix = new mini3d.Matrix4();\n    projMatrix.setPerspective(30, mini3d.canvas.width/mini3d.canvas.height, 1, 100);\n\n    let mvpMatrix = projMatrix.multiply(viewMatrix);\n    \n    shader.setUniform('u_mvpMatrix', mvpMatrix.elements);\n\n    let gl = mini3d.gl;\n    gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);\n    mesh.render(shader);\n}\n\nexport default function main(){\n    console.log('main');\n    example(mini3d.gl);\n}\n"],"names":["VSHADER_SOURCE","FSHADER_SOURCE","createMesh","format","mini3d","VertexFormat","addAttrib","VertexSemantic","POSITION","COLOR","mesh","Mesh","position_data","color_data","triangels","setVertexData","setTriangles","upload","g_eyeX","g_eyeY","g_eyeZ","example","gl","shader","Shader","create","console","log","mapAttributeSemantic","use","viewMatrix","Matrix4","document","onkeydown","ev","keydown","clearColor","clearDepth","enable","DEPTH_TEST","draw","keyCode","setLookAtGL","projMatrix","setPerspective","canvas","width","height","mvpMatrix","multiply","setUniform","elements","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","render","main"],"mappings":"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"}