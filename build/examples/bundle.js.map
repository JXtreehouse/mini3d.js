{"version":3,"file":"bundle.js","sources":["../../examples/src/AppTexturedCube.js","../../examples/src/AppObjLoader.js","../../examples/src/AppSimpleScene.js","../../src/math/math.js","../../src/math/vector3.js","../../examples/src/AppNormalMap.js","../../examples/src/main.js"],"sourcesContent":["let vs_file = './shaders/tex_color.vs';\r\nlet fs_file = './shaders/tex_color.fs';\r\nlet tex_file = './imgs/box_diffuse.jpg';\r\n\r\n\r\nclass AppTexturedCube{\r\n    constructor(){\r\n        this._inited = false;\r\n        this._mesh = null;\r\n        this._shader = null;\r\n        this._texture = null;\r\n        \r\n        this._viewMatrix = new mini3d.Matrix4();\r\n        this._modelMatrix = new mini3d.Matrix4();\r\n        this._normalMatrix = new mini3d.Matrix4();\r\n        this._viewProjMatrix = new mini3d.Matrix4();\r\n        this._mvpMatrix = new mini3d.Matrix4();\r\n        this._rotX = 30;\r\n        this._rotY = 30;\r\n        this._rotZ = 0;\r\n    }\r\n\r\n    onInit(){\r\n        let assetList = [\r\n            [vs_file, mini3d.AssetType.Text],\r\n            [fs_file, mini3d.AssetType.Text],\r\n            [tex_file, mini3d.AssetType.Image]\r\n        ]\r\n    \r\n        mini3d.assetManager.loadAssetList(assetList, function(){    \r\n            this._inited = true;            \r\n            this.start();\r\n        }.bind(this));\r\n\r\n        this._viewMatrix.setViewByLookAt(.0, .0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0);\r\n    }\r\n\r\n    onResize(width, height){                \r\n        this._viewProjMatrix.setPerspective(60.0, width/height, 1.0, 100.0);\r\n        this._viewProjMatrix.multiply(this._viewMatrix);   \r\n        \r\n        if(this._inited){            \r\n            this.draw();\r\n        }        \r\n    }\r\n\r\n    onUpdate(dt){\r\n       \r\n    }\r\n\r\n    start(){\r\n        let gl = mini3d.gl;\r\n        \r\n        let vs = mini3d.assetManager.getAsset(vs_file).data;\r\n        let fs = mini3d.assetManager.getAsset(fs_file).data;\r\n\r\n        let shader = new mini3d.Shader();\r\n        if(!shader.create(vs, fs)){\r\n            console.log(\"Failed to initialize shaders\");\r\n            return;\r\n        }\r\n\r\n        this._shader = shader;\r\n        this._shader.mapAttributeSemantic(mini3d.VertexSemantic.POSITION, 'a_Position');\r\n        this._shader.mapAttributeSemantic(mini3d.VertexSemantic.NORMAL, 'a_Normal');    \r\n        this._shader.mapAttributeSemantic(mini3d.VertexSemantic.UV0, 'a_TexCoord');        \r\n        this._shader.use();\r\n    \r\n        this._texture = mini3d.textureManager.getTexture(tex_file);\r\n        this._mesh = mini3d.Cube.createMesh();              \r\n\r\n        let that = this;\r\n        mini3d.eventManager.addEventHandler(mini3d.SystemEvent.touchMove, function(event, data){      \r\n            let factor = 300/mini3d.canvas.width;      \r\n            let dx = data.dx * factor;\r\n            let dy = data.dy * factor;                        \r\n            \r\n            let clampAngle = function(angle, min, max){\r\n                if(angle<-360) angle+=360;\r\n                if(angle>360) angle-=360;\r\n                return Math.max(Math.min(angle, max), min);\r\n            }\r\n            that._rotX = clampAngle(that._rotX + dy, -90.0, 90.0);\r\n            that._rotY += dx;            \r\n            that.draw();\r\n        });\r\n\r\n        \r\n        gl.clearColor(0, 0, 0, 1);\r\n        gl.clearDepth(1.0);\r\n        gl.enable(gl.DEPTH_TEST);\r\n\r\n        this.draw();\r\n    }    \r\n\r\n    draw(){        \r\n    \r\n        //rotate order: y-x-z\r\n        this._modelMatrix.setRotate(this._rotZ, 0, 0, 1); //rot around z-axis\r\n        this._modelMatrix.rotate(this._rotX, 1.0, 0.0, 0.0); //rot around x-axis\r\n        this._modelMatrix.rotate(this._rotY, 0.0, 1.0, 0.0); //rot around y-axis\r\n\r\n        this._normalMatrix.setInverseOf(this._modelMatrix)\r\n        this._normalMatrix.transpose();\r\n    \r\n        this._mvpMatrix.set(this._viewProjMatrix);\r\n        this._mvpMatrix.multiply(this._modelMatrix);\r\n        \r\n        this._shader.setUniform('u_mvpMatrix', this._mvpMatrix.elements);\r\n        this._shader.setUniform('u_NormalMatrix', this._normalMatrix.elements);\r\n        this._shader.setUniform('u_LightColor', [1.0,1.0,1.0]);\r\n        let lightDir = [0.5, 3.0, 4.0];\r\n        this._shader.setUniform('u_LightDir', lightDir);\r\n    \r\n        this._texture.bind();\r\n        this._shader.setUniform('u_sampler', 0);\r\n    \r\n        let gl = mini3d.gl;\r\n        gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);\r\n        this._mesh.render(this._shader);\r\n    \r\n        this._texture.unbind();\r\n    }\r\n}\r\n\r\nexport default AppTexturedCube;","\r\nlet vs_file = './shaders/basic_light.vs';\r\nlet fs_file = './shaders/basic_light.fs';\r\nlet obj_file = './models/dragon.obj';\r\n\r\n\r\nclass AppObjLoader{\r\n    constructor(){\r\n        this._inited = false;\r\n        this._mesh = null;\r\n        this._shader = null;       \r\n        \r\n        this._viewMatrix = new mini3d.Matrix4();\r\n        this._modelMatrix = new mini3d.Matrix4();\r\n        this._viewProjMatrix = new mini3d.Matrix4();\r\n        this._mvpMatrix = new mini3d.Matrix4();\r\n        this._normalMatrix = new mini3d.Matrix4();\r\n        this._rotationQuat = new mini3d.Quaternion();\r\n        this._matRot = new mini3d.Matrix4();\r\n\r\n        this._rotX = 0;\r\n        this._rotY = 0;\r\n    }\r\n\r\n    onInit(){\r\n        let assetList = [\r\n            [vs_file, mini3d.AssetType.Text],\r\n            [fs_file, mini3d.AssetType.Text],\r\n            [obj_file, mini3d.AssetType.Text]\r\n        ]\r\n    \r\n        mini3d.assetManager.loadAssetList(assetList, function(){                \r\n            this._inited = true;\r\n            this.start();\r\n        }.bind(this));\r\n\r\n        this._viewMatrix.setViewByLookAt(.0, .0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0);\r\n    }\r\n\r\n    onResize(width, height){\r\n        this._viewProjMatrix.setPerspective(60.0, width/height, 1.0, 100.0);\r\n        this._viewProjMatrix.multiply(this._viewMatrix);\r\n\r\n        if(this._inited){            \r\n            this.draw();\r\n        }  \r\n    }\r\n\r\n    onUpdate(dt){\r\n\r\n    }\r\n\r\n    start(){\r\n        let gl = mini3d.gl;\r\n    \r\n        let vs = mini3d.assetManager.getAsset(vs_file).data;\r\n        let fs = mini3d.assetManager.getAsset(fs_file).data;\r\n    \r\n        let shader = new mini3d.Shader();\r\n        if(!shader.create(vs, fs)){\r\n            console.log(\"Failed to initialize shaders\");\r\n            return;\r\n        }\r\n    \r\n        this._shader = shader;\r\n        this._shader.mapAttributeSemantic(mini3d.VertexSemantic.POSITION, 'a_Position');\r\n        this._shader.mapAttributeSemantic(mini3d.VertexSemantic.NORMAL, 'a_Normal');\r\n        this._shader.use();        \r\n    \r\n        let objFileString = mini3d.assetManager.getAsset(obj_file).data;\r\n        this._mesh = mini3d.objFileLoader.load(objFileString, 0.3);                    \r\n        \r\n        let that = this;\r\n        mini3d.eventManager.addEventHandler(mini3d.SystemEvent.touchMove, function(event, data){                           \r\n            let factor = 300/mini3d.canvas.width;      \r\n            let dx = data.dx * factor;\r\n            let dy = data.dy * factor;    \r\n            \r\n            let clampAngle = function(angle, min, max){\r\n                if(angle<-360) angle+=360;\r\n                if(angle>360) angle-=360;\r\n                return Math.max(Math.min(angle, max), min);\r\n            }\r\n            that._rotX = clampAngle(that._rotX + dy, -90.0, 90.0);\r\n            that._rotY += dx;  \r\n    \r\n            //先旋转qy,再旋转qx\r\n            let qx = mini3d.Quaternion.axisAngle(mini3d.Vector3.Right, that._rotX);\r\n            let qy = mini3d.Quaternion.axisAngle(mini3d.Vector3.Up, that._rotY);\r\n            mini3d.Quaternion.multiply(qx, qy, that._rotationQuat);\r\n    \r\n            //欧拉角的约定是先x后y,不是这里要的\r\n            //that._rotationQuat.setFromEulerAngles(new mini3d.Vector3(that._rotX, that._rotY, 0));\r\n    \r\n            mini3d.Quaternion.toMatrix4(that._rotationQuat, that._matRot);\r\n            \r\n            that.draw();\r\n        })\r\n        \r\n    \r\n        gl.clearColor(0, 0, 0, 1);\r\n        gl.clearDepth(1.0);\r\n        gl.enable(gl.DEPTH_TEST);\r\n    \r\n        this.draw();\r\n    }\r\n\r\n    draw(){         \r\n        this._modelMatrix.setTranslate(0, -1.0, 0);               \r\n        this._modelMatrix.multiply(this._matRot);\r\n        this._modelMatrix.scale(1.0, 1.0, 1.0);\r\n    \r\n        this._normalMatrix.setInverseOf(this._modelMatrix)\r\n        this._normalMatrix.transpose();    \r\n    \r\n        this._mvpMatrix.set(this._viewProjMatrix);\r\n        this._mvpMatrix.multiply(this._modelMatrix);\r\n        \r\n        this._shader.setUniform('u_mvpMatrix', this._mvpMatrix.elements);\r\n        this._shader.setUniform('u_NormalMatrix', this._normalMatrix.elements);\r\n        this._shader.setUniform('u_LightColor', [1.0,1.0,1.0]);\r\n        let lightDir = [0.5, 3.0, 4.0];\r\n        this._shader.setUniform('u_LightDir', lightDir);\r\n    \r\n        let gl = mini3d.gl;\r\n        gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);\r\n        this._mesh.render(this._shader);\r\n    \r\n    }\r\n}\r\n\r\nexport default AppObjLoader;","let obj_file_capsule = './models/capsule.obj';\r\nlet obj_file_sphere = './models/sphere.obj';\r\nlet obj_main_texture = './imgs/wall01_diffuse.jpg';\r\nlet plane_main_texture = './imgs/wall02_diffuse.png';\r\n\r\nclass AppSimpleScene {\r\n    constructor() {             \r\n        this._time = 0;        \r\n        this._rotDegree = 0;\r\n        this._tempQuat = new mini3d.Quaternion();\r\n        this._tempVec3 = new mini3d.Vector3();\r\n    }\r\n\r\n    onInit() {\r\n        let assetList = [\r\n            [obj_file_capsule, mini3d.AssetType.Text],\r\n            [obj_file_sphere, mini3d.AssetType.Text],\r\n            [obj_main_texture, mini3d.AssetType.Image],\r\n            [plane_main_texture, mini3d.AssetType.Image]\r\n        ]\r\n\r\n        mini3d.assetManager.loadAssetList(assetList, function () {            \r\n            this.start();\r\n        }.bind(this));\r\n    }\r\n\r\n    onResize(width, height) {\r\n        if (this._scene) {\r\n            this._scene.onScreenResize(width, height);\r\n        }\r\n    }    \r\n\r\n    start() {\r\n        this.createWorld();\r\n        \r\n        mini3d.eventManager.addEventHandler(mini3d.SystemEvent.touchMove, function (event, data) {\r\n            let factor = 0.01;\r\n            let dx = data.dx;\r\n            let dy = data.dy;\r\n\r\n            this._tempVec3.copyFrom(this._mesh2.localPosition);\r\n            this._tempVec3.z += dy * factor;\r\n            this._tempVec3.x += dx * factor;\r\n            this._mesh2.localPosition = this._tempVec3;\r\n\r\n        }.bind(this));\r\n    }\r\n\r\n    createWorld() {\r\n\r\n        // Load meshes\r\n        let capusleData = mini3d.assetManager.getAsset(obj_file_capsule).data;\r\n        let capusleMesh = mini3d.objFileLoader.load(capusleData, 1.0, true);\r\n\r\n        let sphereData = mini3d.assetManager.getAsset(obj_file_sphere).data;\r\n        let sphereMesh = mini3d.objFileLoader.load(sphereData, 1.0);\r\n\r\n        \r\n        // Create scene\r\n        this._scene = new mini3d.Scene();\r\n\r\n        // Create a plane\r\n        let planeMesh = mini3d.Plane.createMesh(20, 20, 20, 20);\r\n        let matPlane = new mini3d.MatPixelLight();\r\n        matPlane.mainTexture = mini3d.textureManager.getTexture(plane_main_texture);\r\n        matPlane.mainTexture.setRepeat();\r\n        matPlane.mainTextureST = [2,2,0,0];\r\n        matPlane.specular = [0.8, 0.8, 0.8];\r\n        this._planeNode = this._scene.root.addMeshNode(planeMesh, matPlane);\r\n        this._planeNode.localPosition.set(0,0,0);       \r\n\r\n        // Create an empty mesh root node\r\n        let meshRoot = this._scene.root.addEmptyNode();        \r\n        //meshRoot.localPosition.set(-1, 1, 1);\r\n        //meshRoot.localScale.set(0.8, 1, 1);\r\n        //meshRoot.localRotation.setFromAxisAngle(new mini3d.Vector3(0, 1, 0), 45);\r\n\r\n        // Create mesh node 1\r\n        let material1 = new mini3d.MatPixelLight();\r\n        material1.mainTexture = mini3d.textureManager.getTexture(obj_main_texture);\r\n        material1.colorTint = [1.0, 1.0, 1.0];\r\n        material1.specular = [0.8, 0.8, 0.8];\r\n\r\n        this._mesh1 = meshRoot.addMeshNode(capusleMesh, material1);\r\n        this._mesh1.localPosition.set(1, 1, 0);        \r\n        \r\n        // Create mesh node 2\r\n        let material2 = new mini3d.MatPixelLight();\r\n        material2.mainTexture = mini3d.textureManager.getTexture(obj_main_texture);\r\n        material2.colorTint = [1.0, 1.0, 1.0];\r\n        material2.specular = [0.8, 0.8, 0.8];\r\n        material2.gloss = 20;\r\n\r\n        this._mesh2 = meshRoot.addMeshNode(capusleMesh, material2);\r\n        this._mesh2.localPosition.set(-1, 1, 0);\r\n        this._mesh2.localScale.set(1, 1, 1);\r\n        \r\n        // Add a directional light node to scene\r\n        let mainLight = this._scene.root.addDirectionalLight([0.5,0.5,0.5]);\r\n        //this._tempQuat.setFromEulerAngles(this._tempVec3.set(135,45,0));\r\n        //mainLight.localRotation = this._tempQuat;\r\n        mainLight.lookAt(this._tempVec3.set(-1,-1,-1));\r\n\r\n        // Add point light 1\r\n        let lightColor = [0,0.1,0];\r\n        let pointLight = this._scene.root.addPointLight(lightColor,10);\r\n        pointLight.localPosition.set(-5, 6, 0);\r\n        let lightball = pointLight.addMeshNode(sphereMesh, new mini3d.MatSolidColor([0.3,0.9,0.3])); //点光源身上放一个小球以显示他的位置   \r\n        lightball.localScale.set(0.5,0.5,0.5);\r\n        this._pointLight1 = pointLight;             \r\n\r\n        // Add point light 2\r\n        lightColor = [0.1,0,0];\r\n        pointLight = this._scene.root.addPointLight(lightColor,10);\r\n        pointLight.localPosition.set(5, 6, 0);\r\n        lightball = pointLight.addMeshNode(sphereMesh, new mini3d.MatSolidColor([0.9,0.3,0.3]));\r\n        lightball.localScale.set(0.5,0.5,0.5);\r\n        this._pointLight2 = pointLight;\r\n        \r\n        // Add a perspective camera\r\n        this._cameraNode = this._scene.root.addPerspectiveCamera(60, mini3d.canvas.width / mini3d.canvas.height, 1.0, 1000);        \r\n        this._cameraNode.localPosition.set(0, 10, 10);\r\n        this._cameraNode.lookAt(new mini3d.Vector3(0, 0, 0));\r\n        this._cameraNode.camera.clearColor = [0.2,0.5,0.5];\r\n\r\n    }\r\n\r\n    onUpdate(dt) {\r\n        if (this._scene) {\r\n            this._time += dt;\r\n            this._scene.update();\r\n\r\n            //mesh2自动旋转\r\n            if(true){\r\n                this._mesh2.localRotation.setFromEulerAngles(new mini3d.Vector3(this._rotDegree, this._rotDegree, this._rotDegree));\r\n                this._mesh2.localPosition.y = (0.5+0.5*Math.cos(mini3d.math.degToRad(this._rotDegree)))*5;\r\n                this._mesh2.setTransformDirty();\r\n                this._rotDegree += dt*100/1000;\r\n                this._rotDegree %= 360;                       \r\n            }\r\n\r\n            //mesh1看向mesh2\r\n            this._mesh1.lookAt(this._mesh2.worldPosition, mini3d.Vector3.Up, 0.1);                    \r\n           \r\n            //灯光做圆周运动\r\n            let cosv = Math.cos(this._time/1000);\r\n            let sinv = Math.sin(this._time/1000);\r\n            let radius = 5;\r\n            \r\n            this._pointLight1.localPosition.x = radius*cosv*cosv;\r\n            this._pointLight1.localPosition.z = radius*sinv*cosv;\r\n            this._pointLight1.localPosition.y = 1+radius*(0.5+0.5*sinv);\r\n            this._pointLight1.setTransformDirty();\r\n\r\n            this._pointLight2.localPosition.x = -radius*cosv*cosv;\r\n            this._pointLight2.localPosition.z = -radius*sinv*cosv;\r\n            this._pointLight2.localPosition.y = 1+radius*(0.5+0.5*sinv);\r\n            this._pointLight2.setTransformDirty();\r\n\r\n           \r\n            this._scene.render();\r\n        }\r\n    }\r\n}\r\n\r\nexport default AppSimpleScene;","\r\nclass MathUtils{\r\n    constructor(){\r\n        this.Pi = 3.141592654;\r\n        this.TwoPi = 6.283185307;\r\n        this.HalfPi = 1.570796327;\r\n\r\n        this.Epsilon = 0.000001;\r\n        this.ZeroEpsilon = 32.0 * 1.175494351e-38; // Very small epsilon for checking against 0.0f\r\n    }\r\n\r\n    degToRad(degree){\r\n        return degree * 0.017453293;\r\n    }\r\n\r\n    radToDeg(rad){\r\n        return rad * 57.29577951;\r\n    }\r\n\r\n    clamp(f, min, max){\r\n        if(f<min) f = min;\r\n        else if(f>max) f = max;\r\n        return f;\r\n    }\r\n}\r\n\r\nlet math = new MathUtils();\r\n\r\nexport { math };","import { math } from \"./math\";\r\n\r\nclass Vector3{\r\n    constructor(x=0,y=0,z=0){\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n\r\n    clone(){\r\n        return new Vector3(this.x, this.y, this.z);\r\n    }\r\n\r\n    set(x,y,z){\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n        return this;\r\n    }\r\n\r\n    length(){\r\n        return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);\r\n    }\r\n\r\n    lengthSquare(){\r\n        return this.x*this.x+this.y*this.y+this.z*this.z;\r\n    }\r\n\r\n    equals(rhs){\r\n        let eps = math.Epsilon;\r\n        return (this.x > rhs.x - eps && this.x < rhs.x + eps &&\r\n                this.y > rhs.y - eps && this.y < rhs.y + eps &&\r\n                this.z > rhs.z - eps && this.z < rhs.z + eps);\r\n    }\r\n\r\n    copyFrom(rhs){\r\n        this.x = rhs.x;\r\n        this.y = rhs.y;\r\n        this.z = rhs.z;\r\n        return this;\r\n    }\r\n\r\n    negative(){\r\n        this.x = -this.x;\r\n        this.y = -this.y;\r\n        this.z = -this.z;\r\n        return this;\r\n    }\r\n\r\n    add(rhs){\r\n        this.x += rhs.x;\r\n        this.y += rhs.y;\r\n        this.z += rhs.z;\r\n        return this;\r\n    }\r\n\r\n    sub(rhs){\r\n        this.x -= rhs.x;\r\n        this.y -= rhs.y;\r\n        this.z -= rhs.z;\r\n        return this;\r\n    }\r\n\r\n    multiply(rhs){\r\n        this.x *= rhs.x;\r\n        this.y *= rhs.y;\r\n        this.z *= rhs.z;\r\n        return this;\r\n    }\r\n\r\n    scale(s){\r\n        this.x *= s;\r\n        this.y *= s;\r\n        this.z *= s;\r\n        return this;\r\n    }\r\n\r\n    normalize(){\r\n        let lensq =this.x*this.x+this.y*this.y+this.z*this.z;\r\n        if(lensq > 0){\r\n           let g = 1/Math.sqrt(lensq);\r\n           this.x *= g;\r\n           this.y *= g;\r\n           this.z *= g;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    static copyTo(src, dst){\r\n        dst.x = src.x;\r\n        dst.y = src.y;\r\n        dst.z = src.z;\r\n        return dst;\r\n    }\r\n\r\n    static negativeTo(src, dst){\r\n        dst.x = -src.x;\r\n        dst.y = -src.y;\r\n        dst.z = -src.z;\r\n        return dst;\r\n    }\r\n\r\n    static add(a, b, dst){\r\n        dst.x = a.x + b.x;\r\n        dst.y = a.y + b.y;\r\n        dst.z = a.z + b.z;\r\n        return dst;\r\n    }\r\n\r\n    static sub(a, b, dst){\r\n        dst.x = a.x - b.x;\r\n        dst.y = a.y - b.y;\r\n        dst.z = a.z - b.z;\r\n        return dst;\r\n    }\r\n\r\n    static multiply(a, b, dst){\r\n        dst.x = a.x * b.x;\r\n        dst.y = a.y * b.y;\r\n        dst.z = a.z * b.z;\r\n        return dst;\r\n    }\r\n\r\n    static scaleTo(a, s, dst){\r\n        dst.x = a.x * s;\r\n        dst.y = a.y * s;\r\n        dst.z = a.z * s;\r\n        return dst;\r\n    }\r\n\r\n    static dot(a, b){\r\n        return a.x * b.x + a.y * b.y + a.z * b.z;\r\n    }\r\n\r\n    static cross(a, b, dst){\r\n        dst.x = a.y * b.z - a.z * b.y;\r\n        dst.y = a.z * b.x - a.x * b.z;\r\n        dst.z = a.x * b.y - a.y * b.x;\r\n        return dst;\r\n    }\r\n\r\n    static lerp(a, b, f, dst){\r\n        dst.x = a.x + (b.x-a.x)*f;\r\n        dst.y = a.y + (b.y-a.y)*f;\r\n        dst.z = a.z + (b.z-a.z)*f;\r\n        return dst;\r\n    }\r\n\r\n    static distance(a,b){\r\n        let dx = a.x - b.x;\r\n        let dy = a.y - b.y;\r\n        let dz = a.z - b.z;\r\n        return Math.sqrt(dx*dx+dy*dy+dz*dz);\r\n    }\r\n\r\n    static distanceSquare(a,b){\r\n        let dx = a.x - b.x;\r\n        let dy = a.y - b.y;\r\n        let dz = a.z - b.z;\r\n        return dx*dx+dy*dy+dz*dz;\r\n    }\r\n}\r\n\r\nVector3.Right = new Vector3(1, 0, 0);\r\nVector3.Up = new Vector3(0, 1, 0);\r\n\r\nexport { Vector3 };","import { Vector3 } from \"../../src/math/vector3\";\r\n\r\nlet obj_file_capsule = './models/capsule.obj';\r\nlet obj_file_sphere = './models/sphere.obj';\r\nlet obj_main_texture = './imgs/wall01_diffuse.jpg';\r\nlet obj_normal_map = './imgs/wall01_normal.jpg';\r\nlet box_main_texture = './imgs/box_diffuse.jpg';\r\nlet box_normal_map = './imgs/box_normal.jpg';\r\nlet plane_main_texture = './imgs/wall02_diffuse.png';\r\nlet plane_normal_map = './imgs/wall02_normal.png';\r\nlet brick_main_texture = './imgs/brickwall_diffuse.jpg';\r\nlet brick_normal_map = './imgs/brickwall_normal.jpg';\r\n\r\nclass AppNormalMap {\r\n    constructor() {             \r\n        this._time = 0;     \r\n        this._rotX = 0;\r\n        this._rotY = 0;           \r\n        this._tempQuat = new mini3d.Quaternion();\r\n        this._tempVec3 = new mini3d.Vector3();\r\n    }\r\n\r\n    onInit() {\r\n        let assetList = [\r\n            [obj_file_capsule, mini3d.AssetType.Text],\r\n            [obj_file_sphere, mini3d.AssetType.Text],\r\n            [obj_main_texture, mini3d.AssetType.Image],\r\n            [obj_normal_map, mini3d.AssetType.Image],\r\n            [box_main_texture, mini3d.AssetType.Image],\r\n            [box_normal_map, mini3d.AssetType.Image],\r\n            [plane_main_texture, mini3d.AssetType.Image],\r\n            [plane_normal_map, mini3d.AssetType.Image],\r\n            [brick_main_texture, mini3d.AssetType.Image],\r\n            [brick_normal_map, mini3d.AssetType.Image]\r\n        ]\r\n\r\n        mini3d.assetManager.loadAssetList(assetList, function () {            \r\n            this.start();\r\n        }.bind(this));\r\n    }\r\n\r\n    onResize(width, height) {\r\n        if (this._scene) {\r\n            this._scene.onScreenResize(width, height);\r\n        }\r\n    }    \r\n\r\n    start() {\r\n        this.createWorld();\r\n        \r\n        mini3d.eventManager.addEventHandler(mini3d.SystemEvent.touchMove, function (event, data) {            \r\n            let dx = data.dx;\r\n            let dy = data.dy;\r\n\r\n            let clampAngle = function (angle, min, max) {\r\n                if (angle < -360) angle += 360;\r\n                if (angle > 360) angle -= 360;\r\n                return Math.max(Math.min(angle, max), min);\r\n            }\r\n            this._rotX = clampAngle(this._rotX + dy, -90.0, 90.0);\r\n            this._rotY += dx;\r\n\r\n            //先旋转qy,再旋转qx\r\n            let qx = mini3d.Quaternion.axisAngle(mini3d.Vector3.Right, this._rotX);\r\n            let qy = mini3d.Quaternion.axisAngle(mini3d.Vector3.Up, this._rotY);\r\n            mini3d.Quaternion.multiply(qx, qy, this._tempQuat);\r\n            this._mesh1.localRotation = this._tempQuat;\r\n            this._mesh2.localRotation = this._tempQuat;\r\n\r\n        }.bind(this));\r\n    }\r\n\r\n    createGround(){\r\n        let groundMesh = mini3d.Plane.createMesh(20, 10, 20, 10);\r\n        let matGround = new mini3d.MatNormalMap();\r\n        matGround.mainTexture = mini3d.textureManager.getTexture(plane_main_texture);\r\n        matGround.mainTexture.setRepeat();\r\n        matGround.mainTextureST = [3,3,0,0];\r\n        matGround.normalMap = mini3d.textureManager.getTexture(plane_normal_map);\r\n        matGround.normalMap.setRepeat();\r\n        matGround.normalMapST = [3,3,0,0];\r\n        matGround.specular = [0.8, 0.8, 0.8];\r\n        let groundNode = this._scene.root.addMeshNode(groundMesh, matGround);\r\n        groundNode.localPosition.set(0,0,0); \r\n    }\r\n\r\n    createWall(){\r\n        let wallMesh = mini3d.Plane.createMesh(20, 10, 20, 10);\r\n        let matWall = new mini3d.MatNormalMap();\r\n        matWall.mainTexture =  mini3d.textureManager.getTexture(brick_main_texture);\r\n        matWall.mainTexture.setRepeat();\r\n        matWall.mainTextureST = [3,3,0,0];\r\n        matWall.normalMap = mini3d.textureManager.getTexture(brick_normal_map);\r\n        matWall.normalMap.setRepeat();\r\n        matWall.normalMapST = [3,3,0,0];\r\n        matWall.specular = [0.8, 0.8, 0.8];\r\n        return this._scene.root.addMeshNode(wallMesh, matWall);\r\n    }\r\n\r\n    createMirror(texture){\r\n        let mirrorMesh = mini3d.Plane.createMesh(6,6,2,2);\r\n        let matMirror = new mini3d.MatMirror();\r\n        matMirror.mainTexture = texture;\r\n        let node = this._scene.root.addMeshNode(mirrorMesh, matMirror);\r\n        node.localPosition.set(0, 2, -4);\r\n        node.localRotation.setFromEulerAngles(this._tempVec3.set(90,0,0));\r\n    }\r\n\r\n    createWorld() {\r\n\r\n        // Load meshes\r\n        let capusleData = mini3d.assetManager.getAsset(obj_file_capsule).data;\r\n        let capusleMesh = mini3d.objFileLoader.load(capusleData, 1.0, true);\r\n\r\n        let sphereData = mini3d.assetManager.getAsset(obj_file_sphere).data;\r\n        let sphereMesh = mini3d.objFileLoader.load(sphereData, 1.0, true);\r\n\r\n        \r\n        // Create scene\r\n        this._scene = new mini3d.Scene();\r\n\r\n        // Create the ground\r\n        this.createGround();  \r\n        \r\n        // Create walls\r\n        let wall1 = this.createWall();\r\n        wall1.localPosition.set(0, 5, -5);\r\n        wall1.localRotation.setFromEulerAngles(new Vector3(90,0,0));\r\n        \r\n\r\n        // Create an empty mesh root node\r\n        let meshRoot = this._scene.root.addEmptyNode();        \r\n        //meshRoot.localPosition.set(-1, 1, 1);\r\n        //meshRoot.localScale.set(0.8, 1, 1);\r\n        //meshRoot.localRotation.setFromAxisAngle(new mini3d.Vector3(0, 1, 0), 45);\r\n\r\n        // Create mesh node 1\r\n        let material1 = new mini3d.MatNormalMap();\r\n        material1.mainTexture = mini3d.textureManager.getTexture(obj_main_texture);\r\n        material1.normalMap = mini3d.textureManager.getTexture(obj_normal_map);        \r\n        material1.colorTint = [1.0, 1.0, 1.0];\r\n        material1.specular = [0.8, 0.8, 0.8];\r\n\r\n        this._mesh1 = meshRoot.addMeshNode(capusleMesh, material1);\r\n        this._mesh1.localPosition.set(1, 1, 0);        \r\n        \r\n        // Create mesh node 2\r\n        let material2 = new mini3d.MatNormalMapW();\r\n        material2.mainTexture = mini3d.textureManager.getTexture(box_main_texture);\r\n        material2.normalMap = mini3d.textureManager.getTexture(box_normal_map);        \r\n        material2.colorTint = [1.0, 1.0, 1.0];\r\n        material2.specular = [0.8, 0.8, 0.8];\r\n        material2.gloss = 10;\r\n\r\n        this._mesh2 = meshRoot.addMeshNode(mini3d.Cube.createMesh(), material2);\r\n        this._mesh2.localPosition.set(-1, 1, 0);\r\n        this._mesh2.localScale.set(0.8, 0.8, 0.8);\r\n        \r\n        // Add a directional light node to scene        \r\n        let mainLight = this._scene.root.addDirectionalLight([0.8,0.8,0.8]);\r\n        //this._tempQuat.setFromEulerAngles(this._tempVec3.set(135,-45,0));\r\n        //mainLight.localRotation = this._tempQuat;\r\n        mainLight.lookAt(this._tempVec3.set(-1,-1,-1));\r\n\r\n        // Add point light 1\r\n        let lightColor = [0.05,0.05,0.05];\r\n        let pointLight = this._scene.root.addPointLight(lightColor,10);\r\n        pointLight.localPosition.set(-5, 6, 0);\r\n        let lightball = pointLight.addMeshNode(sphereMesh, new mini3d.MatSolidColor([0.9,0.9,0.9])); //点光源身上放一个小球以显示他的位置   \r\n        lightball.localScale.set(0.2,0.2,0.2);\r\n        this._pointLight1 = pointLight;             \r\n\r\n        // Add point light 2\r\n        lightColor = [0.05,0.05,0.05];\r\n        pointLight = this._scene.root.addPointLight(lightColor,10);\r\n        pointLight.localPosition.set(5, 6, 0);\r\n        lightball = pointLight.addMeshNode(sphereMesh, new mini3d.MatSolidColor([0.9,0.9,0.9]));\r\n        lightball.localScale.set(0.2,0.2,0.2);\r\n        this._pointLight2 = pointLight;\r\n\r\n        // Add a perspective camera\r\n        this._cameraNode = this._scene.root.addPerspectiveCamera(60, mini3d.canvas.width / mini3d.canvas.height, 1.0, 1000);        \r\n        this._cameraNode.localPosition.set(0, 2, 6);\r\n        this._cameraNode.lookAt(new mini3d.Vector3(0, 1, 0));\r\n        this._cameraNode.camera.clearColor = [0.34,0.98,1];\r\n\r\n        // Add a render texture\r\n        this._renderTexture = new mini3d.RenderTexture(512,512);\r\n        this._renderCamera = this._scene.root.addPerspectiveCamera(60, 1.0, 1.0, 1000);        \r\n        this._renderCamera.localPosition.set(0, 2, -6);\r\n        this._renderCamera.lookAt(new mini3d.Vector3(0, 1, 0));\r\n        this._renderCamera.camera.clearColor = [0.34,0.98,1];\r\n        this._renderCamera.camera.target = this._renderTexture;\r\n\r\n        this.createMirror(this._renderTexture.texture2D);\r\n    }\r\n\r\n    onUpdate(dt) {\r\n        if (this._scene) {\r\n            this._time += dt;\r\n            this._scene.update();             \r\n           \r\n            //灯光做圆周运动\r\n            let cosv = Math.cos(this._time/1500);\r\n            let sinv = Math.sin(this._time/1500);\r\n            let radius = 5;\r\n            \r\n            this._pointLight1.localPosition.x = radius*cosv*cosv;\r\n            this._pointLight1.localPosition.z = radius*sinv*cosv;\r\n            this._pointLight1.localPosition.y = 0.5 + radius*(0.5+0.5*sinv)*0.5;\r\n            this._pointLight1.setTransformDirty();\r\n\r\n            this._pointLight2.localPosition.x = -radius*cosv*cosv;\r\n            this._pointLight2.localPosition.z = -radius*sinv*cosv;\r\n            this._pointLight2.localPosition.y = 0.5 + radius*(0.5+0.5*sinv)*0.5;\r\n            this._pointLight2.setTransformDirty();\r\n\r\n            this._scene.render();\r\n        }\r\n    }\r\n}\r\n\r\nexport default AppNormalMap;","import AppTexturedCube from \"./AppTexturedCube\";\r\nimport AppObjLoader from \"./AppObjLoader\";\r\nimport AppSimpleScene from \"./AppSimpleScene\";\r\nimport AppNormalMap from \"./AppNormalMap\";\r\n\r\nfunction exampleTexturedCube(){\r\n    let app = new AppTexturedCube();    \r\n    mini3d.init('webgl', app);\r\n}\r\n\r\nfunction exampleObjLoader(){   \r\n    \r\n    let app = new AppObjLoader();\r\n    mini3d.init('webgl', app);\r\n}\r\n\r\nfunction exampleSimpleScene(){\r\n    let app = new AppSimpleScene();\r\n    mini3d.init('webgl', app);\r\n}\r\n\r\nfunction exampleNormalMap(){\r\n    let app = new AppNormalMap();\r\n    mini3d.init('webgl', app);\r\n}\r\n\r\nlet examples = [\r\n    {\r\n        name:'Textured Cube',\r\n        entry:exampleTexturedCube\r\n    },\r\n    {\r\n        name:'Load .Obj Mesh',\r\n        entry:exampleObjLoader\r\n    },\r\n    {\r\n        name:'Simple Scene',\r\n        entry:exampleSimpleScene\r\n    },\r\n    {\r\n        name:'Normal Map',\r\n        entry:exampleNormalMap\r\n    }\r\n]\r\n\r\nexport default function main(){\r\n    return examples;\r\n}\r\n"],"names":["vs_file","fs_file","tex_file","AppTexturedCube","_inited","_mesh","_shader","_texture","_viewMatrix","mini3d","Matrix4","_modelMatrix","_normalMatrix","_viewProjMatrix","_mvpMatrix","_rotX","_rotY","_rotZ","assetList","AssetType","Text","Image","assetManager","loadAssetList","start","bind","setViewByLookAt","width","height","setPerspective","multiply","draw","dt","gl","vs","getAsset","data","fs","shader","Shader","create","console","log","mapAttributeSemantic","VertexSemantic","POSITION","NORMAL","UV0","use","textureManager","getTexture","Cube","createMesh","that","eventManager","addEventHandler","SystemEvent","touchMove","event","factor","canvas","dx","dy","clampAngle","angle","min","max","Math","clearColor","clearDepth","enable","DEPTH_TEST","setRotate","rotate","setInverseOf","transpose","set","setUniform","elements","lightDir","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","render","unbind","obj_file","AppObjLoader","_rotationQuat","Quaternion","_matRot","objFileString","objFileLoader","load","qx","axisAngle","Vector3","Right","qy","Up","toMatrix4","setTranslate","scale","obj_file_capsule","obj_file_sphere","obj_main_texture","plane_main_texture","AppSimpleScene","_time","_rotDegree","_tempQuat","_tempVec3","_scene","onScreenResize","createWorld","copyFrom","_mesh2","localPosition","z","x","capusleData","capusleMesh","sphereData","sphereMesh","Scene","planeMesh","Plane","matPlane","MatPixelLight","mainTexture","setRepeat","mainTextureST","specular","_planeNode","root","addMeshNode","meshRoot","addEmptyNode","material1","colorTint","_mesh1","material2","gloss","localScale","mainLight","addDirectionalLight","lookAt","lightColor","pointLight","addPointLight","lightball","MatSolidColor","_pointLight1","_pointLight2","_cameraNode","addPerspectiveCamera","camera","update","localRotation","setFromEulerAngles","y","cos","math","degToRad","setTransformDirty","worldPosition","cosv","sinv","sin","radius","MathUtils","Pi","TwoPi","HalfPi","Epsilon","ZeroEpsilon","degree","rad","f","sqrt","rhs","eps","s","lensq","g","src","dst","a","b","dz","obj_normal_map","box_main_texture","box_normal_map","plane_normal_map","brick_main_texture","brick_normal_map","AppNormalMap","groundMesh","matGround","MatNormalMap","normalMap","normalMapST","groundNode","wallMesh","matWall","texture","mirrorMesh","matMirror","MatMirror","node","createGround","wall1","createWall","MatNormalMapW","_renderTexture","RenderTexture","_renderCamera","target","createMirror","texture2D","exampleTexturedCube","app","init","exampleObjLoader","exampleSimpleScene","exampleNormalMap","examples","name","entry","main"],"mappings":"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"}