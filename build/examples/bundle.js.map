{"version":3,"file":"bundle.js","sources":["../../examples/src/main.js"],"sourcesContent":["var VSHADER_SOURCE=`\n    attribute vec4 a_Position;\n    attribute vec4 a_Color;\n    attribute float a_Custom;    \n    uniform mat4 u_mvpMatrix;\n    varying vec4 v_Color;\n    varying float v_Custom;\n    void main(){\n        gl_Position = u_mvpMatrix * a_Position;\n        v_Color = a_Color;\n        v_Custom = a_Custom;\n    }\n`;\n\nvar FSHADER_SOURCE=`\n    #ifdef GL_ES\n    precision mediump float;\n    #endif\n    varying vec4 v_Color;\n    varying float v_Custom;\n    void main(){\n        gl_FragColor = v_Color * v_Custom;\n    }\n`;\n\nconst Semantic_Custom = 'custom';\n\nfunction createMesh(){\n\n    let format = new mini3d.VertexFormat();\n    format.addAttrib(mini3d.VertexSemantic.POSITION, 3);\n    format.addAttrib(mini3d.VertexSemantic.COLOR, 3);\n    format.addAttrib(Semantic_Custom, 1);\n\n    let mesh = new mini3d.Mesh(format);    \n    let position_data = [\n        0.0, 0.5, -0.4,\n        -0.5, -0.5, -0.4,\n        0.5, -0.5, -0.4,\n        0.5, 0.4, -0.2,\n        -0.5, 0.4, -0.2,\n        0.0, -0.6, -0.2,\n        0.0, 0.5, 0.0,\n        -0.5, -0.5, 0.0,\n        0.5, -0.5, 0.0\n    ];\n    let color_data = [\n        0.4, 1.0, 0.4,\n        0.4, 1.0, 0.4,\n        1.0, 0.4, 0.4,\n        1.0, 0.4, 0.4,\n        1.0, 1.0, 0.4,\n        1.0, 1.0, 0.4,\n        0.4, 0.4, 1.0,\n        0.4, 0.4, 1.0,\n        1.0, 0.4, 0.4\n    ];\n    let custom_data = [\n        0.5,\n        0.5,\n        0.5,\n        1,\n        1,\n        1,\n        2,\n        2,\n        2\n    ];\n\n    mesh.setVertexData(mini3d.VertexSemantic.POSITION, position_data);    \n    mesh.setVertexData(mini3d.VertexSemantic.COLOR, color_data);\n    mesh.setVertexData(Semantic_Custom, custom_data);\n    mesh.upload();            \n\n    return mesh;   \n}\n\nlet g_eyeX, g_eyeY, g_eyeZ;\n\nfunction example(gl){\n    let shader = new mini3d.Shader();\n    if(!shader.create(VSHADER_SOURCE, FSHADER_SOURCE)){\n        console.log(\"Failed to initialize shaders\");\n        return;\n    }\n\n    shader.mapAttributeSemantic(mini3d.VertexSemantic.POSITION, 'a_Position');\n    shader.mapAttributeSemantic(mini3d.VertexSemantic.COLOR, 'a_Color');\n    shader.mapAttributeSemantic(Semantic_Custom, 'a_Custom');\n\n    shader.use();    \n    \n    let viewMatrix = new mini3d.Matrix4();\n    g_eyeX = 0.2;\n    g_eyeY = 0.25;\n    g_eyeZ = 0.25;\n\n    var mesh = createMesh(); \n\n    document.onkeydown = function(ev){\n        keydown(ev, mesh, shader, viewMatrix);\n    }\n\n         \n\n    //let modelMatrix = new mini3d.Matrix4();\n    //modelMatrix.setRotate(-10, 0, 0, 1); //Rotate around z-axis\n\n    //let modelViewMatrix = viewMatrix.multiply(modelMatrix);\n\n    gl.clearColor(0, 0, 0, 1);\n    //gl.enable(gl.DEPTH_TEST);\n\n    draw(mesh, shader, viewMatrix);\n\n}\n\nfunction keydown(ev, mesh, shader, viewMatrix){\n    if(ev.keyCode==39){ //right arrow\n        g_eyeX += 0.01;\n    } else if(ev.keyCode==37){ //left arrow\n        g_eyeX -= 0.01;\n    } else {\n        return;\n    }\n\n    draw(mesh, shader, viewMatrix);\n}\n\nfunction draw(mesh, shader, viewMatrix){\n    viewMatrix.setLookAtGL(g_eyeX, g_eyeY, g_eyeZ,  0, 0, 0,  0, 1, 0); \n    let projMatrix = new mini3d.Matrix4();\n    projMatrix.setOrtho(-1.0, 1.0, -1.0, 1.0, 0.0, 2.0); \n\n    let mvpMatrix = projMatrix.multiply(viewMatrix);\n    \n    shader.setUniform('u_mvpMatrix', mvpMatrix.elements);\n\n    let gl = mini3d.gl;\n    gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);\n    mesh.render(shader);\n}\n\nexport default function main(){\n    console.log('main');\n    example(mini3d.gl);\n}\n"],"names":["VSHADER_SOURCE","FSHADER_SOURCE","Semantic_Custom","createMesh","format","mini3d","VertexFormat","addAttrib","VertexSemantic","POSITION","COLOR","mesh","Mesh","position_data","color_data","custom_data","setVertexData","upload","g_eyeX","g_eyeY","g_eyeZ","example","gl","shader","Shader","create","console","log","mapAttributeSemantic","use","viewMatrix","Matrix4","document","onkeydown","ev","keydown","clearColor","draw","keyCode","setLookAtGL","projMatrix","setOrtho","mvpMatrix","multiply","setUniform","elements","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","render","main"],"mappings":"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"}